---
title: "Do Industries Explain Momentum? A Replication of Moskowitz and Grinblatt 2004"
author: "By Johnson Nei and Reed Sawyers"
date: "January 25, 2015"
output: pdf_document
---
```{r, echo = FALSE, warning=FALSE, results = 'hide', error= F, message=FALSE}
library(ws.data)
  library(lubridate)
  library(dplyr)
  library(ggplot2)
  library(tidyr)
  library(xtable)
```
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
Johnson Nei (Johnson.Nei@williams.edu) and Reed Sawyers (jrs9@williams.edu) are currently students at Williams College and produced this replication as part of the winter study class, Econ 20: Quantitative Equity Analysis. We would like to thank the Professor David Kane and the teaching fellow Yuanchu Dang for their help on this paper. The code used to produce the results in the paper was written in R and is available on the github account (jrs9) under the public repository (Final_project2). Contact David Kane at dave.kane@gmail.com for more information on the project.   
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\  
\  
\ 
\   
\  
\  
\  
\    
\  

### Abstract
We replicated Moskowtiz and Grinblatt's findings on the industry momentum effect using data from more than 3000 large cap US companies over a time period from 1998 to 2007. Moskowtiz and Grinblatt (MG) found that industries that experienced positive returns will, continue to experience positive returns for short and intermediate time frames. [1] They also demonstrated that this "industry momentum effect" is stronger and more profitable than the previously recognized individual stock momentum effect. Our analysis bore out MGâ€™s conclusions, demonstrating that industry momentum is indeed a more powerful indicator of future returns. In addition we also extened their analysis by examining the effect of price on momentum returns. 
\newpage

### 1 Introduction
Moskowitz and Grinblatt's (MG) paper attempted to further investigate the concept of momentum investing that were initially demonstrated by Jegadeesh and Titman (JT) in 1993 [2] . Jegadeesh and Titman found that stocks that increase in price (winners) or decrease in price (losers) will generally continue to win or lose over a 3-12 month period. While in the very short term winner stocks will go down and loser stocks will go up, reverting from their immediate performance.  MG attempted to demonstrate that the profits generated by momentum strategies could be largely attributed to an industry wide momentum effect, i.e. winning industries continue to increase in price over the short and intermediate term, which is stronger predictor than a stock specific effect.Our findings support their conclusions. We demonstrated that industry momentum strategies generate higher returns than stock specific strategies, with our industry momentum producing an average monthly return of .0185 (1.85%) (Ignoring transaction costs) compared to a monthly return of .0051 (.51%) for stock specific strategies. The difference in profits demonstrated by the strategy is most pronounced at the short term horizon, when as expected the stock specific momentum is almost useless producing a return of .0015 (.15%) while the industry momentum produces one of .0118 (1.18%). In addition we also found that for both stocks and industries the portfolios were more profitable at an intermediate time frame than a short one. We suspect that the reason our short term stock returns are positive, albeit insignificantly so, is due to a survivorship bias present in our data set.  

Our data covers 3083 large cap stocks over the time span from 1998 to 2007. To be included in our data set a stock must for at least one year have been in the top 1500 stocks by market cap. The stocks are divided into 69 industries using S&P industry classifications. Our data is significantly different from MG's in three ways. First we separate our stocks into 69 industries while MG used 20 based on SIC codes, secondly, our stocks are predominantly large cap companies while MG used a much wider variety including those with significantly smaller market caps and finally our data covers a smaller 10 year time period from 1998 to 2007 while their data covered 1963-1995.  

Using our data we sort both industries and individual stocks by returns to create two types of portfolio a (1,1) portfolio and a (6,6) portfolio. The (1,1) portfolio means that we sort by returns over a single month, and then hold the securities for a single month. In the (6,6) portfolio we sort by mean returns over the past 6 months and then hold the securities for 6 months. In all cased we go long (or buy) the top 30% of stocks or industries and short the bottom 30% of stocks or industries.   

As an extension we examined the effect of price on the returns provided by the momentum effect. In order to do this we sorted stocks by price on the first day for which a price was available and then cut stocks into two buckets, the top 30% by price and the bottom 30% by price. We then used each bucket to make separate (1,1) and (6,6) portfolios. For industries we calculated the mean price in each industries and then created two buckets from the top 30% of industries by price and the bottom 30% by price. We then once again created a (1,1) and (6,6) portfolio from each bucket. While industries once again performed better than stocks, and both performed better at a (6,6) time frame the buckets containing lower priced stocks and industries actually performed better in 75% of cases. Unfortunately we believe this results of our price extension to be biased by our data set.

###2 Data and Methods
Our data consists of 3083 large cap stocks over the 10 year period from January 2, 1998 to December 31, 2007, which are separated into 69 industries based on the Global Industry Classification Standard (GICS) classification system. In order to be included in our portfolio a stock must have been in the top 1500 stocks by market cap for at least 1 of the years in our data (1998-2007).  

When attempting to calculate 6 month previous returns we were hampered by the fact that for January, February, March, April, and May of 1998 we did not have all the trailing months returns available. Rather than simply throwing these months out, we use what information is available to make the best trailing mean possible, meaning that for January the "6 month trailing mean" is in reality only January's returns, while for April 1998 it is the mean of January, February, March and April.   

At the very end of our data set such as December 2007 also we did not have enough information to project six months ahead, so we cut off our (6,6) portfolios at July 2007, the last month we can look six months ahead.  

Table I is a partial replication of a table MG's table 1. In Table I we present the Average Number of Stocks, Average % of Market cap and Average Industry Returns from the largest 20 of our 69 industries by Average Market Cap.  

Our portfolios are self-financing meaning that the return from the portfolios is the difference in performance of the top 30% on which we take a long position, and the bottom 30% on which we take a short position. 

###Table 1: Summary Statistics for the Top 20 industries by Average Fraction of Market Cap
This table is a partial replication of the table produced by MG on page 1254 of the Journal of Finance in which their paper was published. In this table we report the top twenty industries by average market cap, the average number of stocks in the industry, average fraction of the market cap of the industry, and average monthly returns of the industry. 
```{r, echo = FALSE, results = 'asis', warning=FALSE, message= FALSE}
# gather_data2() -> y
#industry_returns_final() -> r_df
#stock_returns_final() -> ardvark
#table1() -> t1
data(t1)
print(xtable(t1, caption = 'Summary Statistics for the Top 20 industries by Average Fraction of Market Cap', digets = 3), caption.placement = "top", comment = F)
```
###3 Results
Our four basic portfolios were (1,1) individual stocks, (1,1) industries, (6,6) individual stocks, and (6,6) industries. These portfolios had mean monthly returns of .15%, 1.18%, .87% and 1.90% respectively. These results are as expected based on the results of MG. The industry momentum portfolios perform better than the individual stock portfolios in both time frames, while providing the highest returns at the 6 month time frame. For individual stocks the 1 month time frame is effectively 0, while the 6 month time frame does provide positive returns, which agrees with the initially proposed concept of industry momentum by Jegadeesh and Titman in 1993. 

###Table 2: Mean Returns for our four basic portfolios
Table 2 is a partial replication of the table 2 in MG's paper which was found on page 1261 of the journal in which is was published. In this table we record the mean monthly return for the (1,1) and (6,6) indivdual stock and industry wide portfolios. 
```{r, echo = FALSE, results = 'asis', warning=FALSE, message= FALSE}
# gather_data2() -> y
#industry_returns_final() -> r_df
#stock_returns_final() -> ardvark
#final_sort_1(ardvark) -> ind_1
#final_sort_1(r_df) -> stock_1
#final_sort_6(ardvark) -> ind_6
#final_sort_6(r_df) -> stock_6
#t2 <- matrix(c(stock_1, stock_6, ind_1, ind_6), ncol=2,byrow=TRUE)
#rownames(t2) <- c("Individual Stock","Industry")
#colnames(t2) <- c("1,1", "6,6")
#t2 <- as.table(t2)

data(t2)
print(xtable(t2, caption = 'Mean Returns for our four basic portfolios', digits = 4), caption.placement = "top", comment = F)

```
For our extension we created 4 buckets, highly priced industries, highly priced stocks, low priced industries and low priced stocks and then created (6,6) and (1,1) portfolios from those four buckets, resulting in eight separate portfolios. As would be expected, the (6,6) portfolio performed better than the (1,1) for each bucket, and the industry portfolios did better than the stock portfolios. For the (1,1) groupings the higher priced industries outperformed the lower priced industries, but the low priced stocks outperformed the high priced stocks. In addition, at the (6,6) level low price stocks and low price industries outperformed their high price equivalents. We believe that the low price buckets performance, and often dramatically higher than that of the highly priced buckets, is not due to actual operations in the market, but rather bias in our data-set and experimental design.  

Two factors contribute to these results, using all 3083 stocks from the original data set, and creating pricing buckets based on the first recorded price of an asset. By using all 3083 stocks we introduce an element of survivorship bias. For example there might have been 100 identical stocks in 1998 of which 80 went bankrupt, 19 performed normally and 1 performed so well it made it to the top 1500 of stocks by market cap in 2007. Only that 1 that performed extraordinarily would be included in our data. Secondly, we determine the "price" of a stock by the first recorded price of that equity, generally the price on January 2, 1998. These two factors come together to give the illusion of fantastic returns for originally low priced stocks.  

For example if one knows a stock is eventually going to make it into the top 1500, as is a given by our data set, than the lower its price in 1998, the more it will have to grow to eventually make it in, giving the appearance of abnormally high returns. 

### Table 3: Mean returns for industry and stock momentum portfolios split by price
This table includes the returns for 8 portfolios, high Priced Stocks, high priced industries, low priced stocks, and low priced industries for both the (1,1) and (6,6) time frames. Industries perform better than stocks, and all perform better at the longer (6,6) time period. 
``````{r, echo = FALSE, results = 'asis', warning=FALSE, message= FALSE}
## gather_data2() -> y
# namesofallthestocks <- unique(y$m.ind)
# equityprice <- vector()
# for ( i in 1:69) {
#   filter(y, symbol == namesofallthestocks[i]) %>%
#     arrange(v.date) -> df_y_10
#   mean(df_y_10[,5], na.rm = TRUE) -> equityprice[i]
# }
# as.numeric(equityprice) -> equityprice2
# 
# cbind(r_df, equityprice2) -> ardv_price
# ardv_price <- data.frame(ardv_price, stringsAsFactors = FALSE)
# ardv_price <- tbl_df(ardv_price)
# arrange(ardv_price, desc(equityprice2)) -> ardv_price_arranged
# 
# r_df_price_top <- slice(ardv_price_arranged, 1:21)
# r_df_price_bot <- slice(ardv_price_arranged, 47:69)
# namesofallthestocks <- unique(y$symbol)
# equityprice <- vector()
# for ( i in 1:3083) {
#   filter(y, symbol == namesofallthestocks[i]) %>%
#     arrange(v.date) -> df_y_10
#   df_y_10[1,5] -> equityprice[i]
# }
# as.numeric(equityprice) -> equityprice2
# 
# cbind(ardvark, equityprice2) -> ardv_price
# ardv_price <- data.frame(ardv_price, stringsAsFactors = FALSE)
# ardv_price <- tbl_df(ardv_price)
# arrange(ardv_price, desc(equityprice2)) -> ardv_price_arranged
# 
# ard_price_top <- slice(ardv_price_arranged, 1:930)
# ard_price_bot <- slice(ardv_price_arranged, 2150:3083)
#final_sort_1(r_df_price_top) -> industry_top_1
#final_sort_1(r_df_price_bot) -> industry_bot_1
#final_sort_6(r_df_price_top) -> industry_top_6
#final_sort_6(r_df_price_bot) -> industry_bot_6
#final_sort_1(ard_price_top) -> stock_top_1
#final_sort_1(ard_price_bot) -> stock_bot_1
#final_sort_6(ard_price_top) -> stock_top_6
#final_sort_6(ard_price_bot) -> stock_bot_6
# t2 <- matrix(c(stock_top_1, stock_top_6, industry_top_1, industry_top_6, stock_bot_1, stock_bot_6, industry_bot_1, industry_bot_6), ncol=2,byrow=TRUE)
# rownames(t2) <- c("Individual Stock-High Price","Industry-High Price", "Individual Stock-Low Price","Industry-Low Price")
# colnames(t2) <- c("1,1", "6,6")
# t2 <- as.table(t2)
# t2 -> t3

data(t3)
print(xtable(t3, caption = 'Mean returns for industry and stock momentum portfolios split by price', digits = 4), caption.placement = "top", comment = F)
```
The following graphs show the cumulative returns over our aprox 120 month period of our Industry (1,1) portfolio, our industry (6,6) portfolio, our stock (1,1) portfolio, and our stock (6,6) portfoli. 
###Table 4: Cumulative Retrun of the (1,1) Industry Portfolio, (1,1) Stock portfolio, (6,6) Industry Portfolio, and (6,6) stock portfolio over 120 months from Jan 1998 to December 2007
```{r, echo = FALSE}
# Date <- c(1:115)
# cbind(Date, stock_diffs_6) -> df1
# data.frame(df1, stringsAsFactors = F) -> df1
# df1 <- tbl_df(df1)
# mutate(df1, cum_ret = cumprod(1+stock_diffs_6) - 1) -> df1
# df1 -> cum_ret_df_s6

# Date <- c(1:119)
# cbind(Date, stock_diffs_1) -> df1
# data.frame(df1, stringsAsFactors = F) -> df1
# df1 <- tbl_df(df1)
# mutate(df1, cum_ret = cumprod(1+stock_diffs_6) - 1) -> df1
# df1 -> cum_ret_df_s6

# Date <- c(1:115)
# cbind(Date, industry_diffs_6) -> df1
# data.frame(df1, stringsAsFactors = F) -> df1
# df1 <- tbl_df(df1)
# mutate(df1, cum_ret = cumprod(1+stock_diffs_6) - 1) -> df1
# df1 -> cum_ret_df_s6

# Date <- c(1:119)
# cbind(Date, industry_diffs_1) -> df1
# data.frame(df1, stringsAsFactors = F) -> df1
# df1 <- tbl_df(df1)
# mutate(df1, cum_ret = cumprod(1+stock_diffs_6) - 1) -> df1
# df1 -> cum_ret_df_s6

data(cum_ret_df_i1)
data(cum_ret_df_i6.RData)
data(cum_ret_df_s1.RData)
data(cum_ret_df_s6.RData)
  ggplot(data = cum_ret_df_i1, aes(Date, cum_ret)) + geom_line(color = "black") +
  geom_line(data = cum_ret_df_i6, aes(Date, cum_ret), color = "green") +
  geom_line(data = cum_ret_df_s1, aes(Date, cum_ret), color = "blue") +
  geom_line(data = cum_ret_df_s6, aes(Date, cum_ret), color = "red") +
  xlab("Months Since January 1998") +
  ylab("Cumulative Returns") +
  ggtitle("Cumulative Returns of Industry (1,1)/(6,6) 
          and Stock (1,1)/(6,6) Portfolios") +
  geom_line(aes(color="Industry 1,1")) +
  geom_line(aes(color="Industry 6,6")) +
  geom_line(aes(color="Stock 1,1")) +
  geom_line(aes(color="Stock 6,6"))+
  theme(legend.title = element_text(colour="black", size=16, face="bold"))+
  scale_color_discrete(name="Legend") +
  scale_x_discrete(breaks=c("0","25","50","75","100"),labels=c("kane","Jan. 2000","Feb. 2003","Mar. 2005","Apr. 2007"))

```
  
###Conclusion
In the past researchers have identified a link between the past performance of stocks and its future performance in the intermediate term, deemed the "momentum effect". Moskowitz and Grinblatt extended that analysis by identifying a momentum effect for industries as a whole and concluded that the industries momentum accounted for a large proportion of the profits realized by individual stock momentum. We analyzed 3083 large cap stocks from 1998 to 2007 that during at least one year were in the top 1500 stocks by market cap. We initially created four portfolios the (1,1) stock, (1,1) industry, (6,6) stock and (6,6) industry. (1,1) indicated that we would take the top (long) and bottom (short) 30% based on mean return for a single month and then hold those positions for a single month, while for (6,6) we based our positions on the past six months mean return and held positions for six months. Portfolios were created each month on a rolling basis and out portfolios were self-funding, indicating that the return was the difference between the return of the long position and the short position. In both the (1,1)  and (6,6) time frames the industry momentum strategy returned substantially more, with the (1,1) individual stock's returns at almost 0. We concluded that the momentum effect is a stronger explanation than individual stock momentum, and that both strategies perform better using the (6,6) time frame.  

As an extension to MG's paper we decided to study the effect of equity price as well as momentum. To do this we separated stocks and industries into high and low price buckets (30%) based on each stocks first recorded price. We than ran each bucket, Stock/High, Stock/Low, Ind/High, Ind/Low through the (1,1) and (6,6) strategies. For every bucket the (6,6) time frame provided higher returns, and industries always out performed stocks in the same price level. Interestingly the low priced bucket actually outperformed the high price buckets for (1,1) stocks and both (6,6) industries and stocks. We hypothesize that this is due to survivorship bias introduced by our methods and data set that must be corrected for in future studies. In summary, Industry and (6,6)  always produce higher returns in our study but there is insufficient evidence to pronounce final judgment on the effect of price in our model.

### Bibliography
* [1] Mark Grinblatt and Tobias J. Moskowitz. Do Industries Explain Momentum?.Journal of Finance, 54(4):1249-1290, October 1999.
* [2] Narasimhan Jegadeesh and Sheridan Titman. Returns to Buying Winners and Selling Losers: Implications for Stock Market Efficiency. Journal of Finance, 48(1):65-91, March 1993.
* [3] R: A Language and Environment for Statistical Computing,R Core Team, R Foundation for  Statistical Computing, Vienna, Austria, 2014, {http://www.R-project.org}


